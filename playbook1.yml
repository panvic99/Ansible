---
- name: Deploying simple web app
  hosts: ec2-instance-1
  vars:
    mysql_root_password: password 
  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes
      become: yes

    - name: Python and its dependencies
      apt: name={{ item }} state=present
      with_items:
        - python
        - python-setuptools
        - python-dev
        - build-essential
        - python-pip
        - python-mysqldb
      become: yes

    - name: Install MySQL database
      apt: name={{ item }} state=present
      with_items:
        - mysql-server
        - mysql-client
      become: yes

    - name: Start the database service
      service: 
        name: mysql
        state: started
        enabled: true

    - name: Create a new database with name 'employee_db'
      mysql_db:
        name: employee_db
        state: present
    
